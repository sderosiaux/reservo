tests/integration/
â”œâ”€â”€ setup.ts                          # Database lifecycle (start/stop/migrate/cleanup)
â”œâ”€â”€ helpers.ts                        # Test utilities and factories
â”‚
â”œâ”€â”€ reservation-commit.test.ts        # ðŸ”¥ CRITICAL CONCURRENCY TESTS
â”‚   â”œâ”€â”€ Basic commit flow (6 tests)
â”‚   â”‚   â”œâ”€â”€ âœ“ Success when capacity available
â”‚   â”‚   â”œâ”€â”€ âœ“ Reject when resource full
â”‚   â”‚   â”œâ”€â”€ âœ“ Reject when resource closed
â”‚   â”‚   â”œâ”€â”€ âœ“ Server timestamp correctness
â”‚   â”‚   â”œâ”€â”€ âœ“ Database persistence
â”‚   â”‚   â””â”€â”€ âœ“ Update resource bookings
â”‚   â”‚
â”‚   â”œâ”€â”€ Concurrency - CRITICAL (4 tests) ðŸŽ¯
â”‚   â”‚   â”œâ”€â”€ âœ“ 100 concurrent â†’ 1 winner (capacity=1)
â”‚   â”‚   â”œâ”€â”€ âœ“ 100 concurrent â†’ 10 winners (capacity=10)
â”‚   â”‚   â”œâ”€â”€ âœ“ Data integrity under race conditions
â”‚   â”‚   â””â”€â”€ âœ“ Multiple resources handled independently
â”‚   â”‚
â”‚   â”œâ”€â”€ Ordering guarantees (2 tests)
â”‚   â”‚   â”œâ”€â”€ âœ“ Monotonically increasing timestamps
â”‚   â”‚   â””â”€â”€ âœ“ Correct reservation ordering
â”‚   â”‚
â”‚   â””â”€â”€ Error handling (2 tests)
â”‚       â”œâ”€â”€ âœ“ Resource not found
â”‚       â””â”€â”€ âœ“ Version conflicts
â”‚
â”œâ”€â”€ repositories.test.ts              # Repository integration tests
â”‚   â”œâ”€â”€ ResourceRepository
â”‚   â”‚   â”œâ”€â”€ CRUD operations (3 tests)
â”‚   â”‚   â”œâ”€â”€ Row-level locking (2 tests)
â”‚   â”‚   â””â”€â”€ Optimistic locking (3 tests)
â”‚   â”‚
â”‚   â”œâ”€â”€ ReservationRepository
â”‚   â”‚   â”œâ”€â”€ CRUD operations (3 tests)
â”‚   â”‚   â”œâ”€â”€ Query operations (3 tests)
â”‚   â”‚   â””â”€â”€ Foreign keys (1 test)
â”‚   â”‚
â”‚   â””â”€â”€ Cross-repository (2 tests)
â”‚       â”œâ”€â”€ âœ“ Atomic transactions
â”‚       â””â”€â”€ âœ“ Rollback on errors
â”‚
â”œâ”€â”€ example.test.ts                   # Example/template tests
â”‚   â”œâ”€â”€ Using test helpers (5 tests)
â”‚   â””â”€â”€ Testing new features (1 test)
â”‚
â””â”€â”€ README.md                         # Documentation

scripts/
â””â”€â”€ run-integration-tests.sh          # Complete test orchestration

vitest.config.integration.ts          # Vitest configuration
